{% extends 'base.html' %}

{% block title %}Events{% endblock %}
{% block page_title %}Events{% endblock %}
{% block page_subtitle %}{{ events.count }} upcoming events{% endblock %}

{% block header_actions %}
<a href="{% url 'admin:planning_event_add' %}" class="px-4 py-2 bg-primary-500 hover:bg-primary-600 text-white text-sm font-medium 
          rounded-lg transition flex items-center gap-2">
    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
    </svg>
    New Event
</a>
{% endblock %}

{% block content %}
<div class="space-y-4">
    {% for event in events %}
    <a href="{% url 'planning:event_detail' event.pk %}"
        class="glass rounded-xl p-4 flex items-center gap-4 hover:bg-white/10 transition group block">
        <!-- Date -->
        <div class="flex-shrink-0 w-16 h-16 rounded-xl bg-primary-500/20 flex flex-col items-center justify-center">
            <span class="text-xs text-primary-400 uppercase">{{ event.date|date:"M" }}</span>
            <span class="text-2xl font-bold text-white">{{ event.date|date:"d" }}</span>
        </div>

        <!-- Info -->
        <div class="flex-1 min-w-0">
            <h3 class="text-lg font-medium text-white group-hover:text-primary-400 transition">
                {{ event.name }}
            </h3>
            <p class="text-sm text-gray-400 mt-1">
                {% for bar in event.bars.all %}{{ bar.name }}{% if not forloop.last %}, {% endif %}{% endfor %}
            </p>
            <div class="flex items-center gap-4 mt-2 text-xs text-gray-500">
                <span>ğŸ“… J-7: {{ event.deadline|date:"M d" }}</span>
                <span>ğŸ“¦ {{ event.deliverables.count }} deliverables</span>
            </div>
        </div>

        <!-- Status -->
        <div class="flex-shrink-0 flex flex-col items-end gap-2">
            {% if event.health_status == 'green' %}
            <span class="px-3 py-1 text-sm rounded-full bg-green-500/20 text-green-400">âœ“ Ready</span>
            {% elif event.health_status == 'orange' %}
            <span class="px-3 py-1 text-sm rounded-full bg-orange-500/20 text-orange-400">â— In Progress</span>
            {% else %}
            <span class="px-3 py-1 text-sm rounded-full bg-red-500/20 text-red-400 animate-pulse">âš  Late</span>
            {% endif %}

            <span class="text-xs text-gray-500">
                {% if event.days_until_event > 0 %}
                in {{ event.days_until_event }} days
                {% elif event.days_until_event == 0 %}
                Today!
                {% else %}
                Past
                {% endif %}
            </span>
        </div>
    </a>
    {% empty %}
    <div class="glass rounded-2xl p-8 text-center">
        <p class="text-gray-400">No upcoming events.</p>
        <a href="{% url 'admin:planning_event_add' %}" class="text-primary-400 hover:underline mt-2 inline-block">
            Create your first event â†’
        </a>
    </div>
    {% endfor %}
</div>
{% endblock %}